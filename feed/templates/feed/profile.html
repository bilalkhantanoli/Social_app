{% extends 'feed/main.html' %}

{% block content %}
<div class="glass-panel" style="padding: 2rem; margin-bottom: 2rem; text-align: center;">
    <div style="margin-bottom: 1rem; position: relative; display: inline-block;">
        <img src="{{ profile_user.profile.avatar.url }}" class="avatar"
            style="width: 120px; height: 120px; border-width: 4px;" alt="{{ profile_user.username }}">
    </div>
    <h1 style="margin-bottom: 0.5rem;">{{ profile_user.username }}</h1>
    <p style="color: var(--text-muted); max-width: 600px; margin: 0 auto 1.5rem auto;">{{ profile_user.profile.bio }}
    </p>

    <!-- Follow / Edit Actions -->
    <div id="follow-btn-container" style="margin-bottom: 2rem;">
        {% if request.user == profile_user %}
        <button class="btn btn-ghost" onclick="document.getElementById('edit-profile-form').style.display='block'">Edit
            Profile</button>
        {% else %}
        {% include 'feed/partials/follow_button.html' %}
        {% endif %}
    </div>

    <!-- Edit Profile Form -->
    {% if p_form %}
    <div id="edit-profile-form" class="glass-panel"
        style="display: none; padding: 1.5rem; margin-top: 1rem; text-align: left;">
        <h3 style="margin-bottom: 1rem;">Edit Profile</h3>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div style="margin-bottom: 1rem;">
                <label>Avatar</label>
                {{ p_form.avatar }}
            </div>
            <div style="margin-bottom: 1rem;">
                <label>Bio</label>
                {{ p_form.bio }}
            </div>
            <button type="submit" class="btn btn-primary">Save Changes</button>
            <button type="button" class="btn btn-ghost"
                onclick="document.getElementById('edit-profile-form').style.display='none'">Cancel</button>
        </form>
    </div>
    {% endif %}
</div>

<h2 style="margin-bottom: 1.5rem; padding-left: 0.5rem;">Posts</h2>
<div id="feed-container">
    {% for post in posts %}
    {% include 'feed/partials/post_card.html' %}
    {% empty %}
    <p style="text-align: center; color: var(--text-muted);">No posts yet.</p>
    {% endfor %}
</div>
{% endblock %}